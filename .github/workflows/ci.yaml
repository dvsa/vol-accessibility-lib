name: CI

on:
    pull_request:
 
jobs:
  
  security:
    name: Security
    uses: ./.github/workflows/security.yaml
    secrets: inherit
   
  build-maven:
   runs-on: ubuntu-latest
   needs: security 
   steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Set up JDK 11
        uses: actions/setup-java@v4
        with:
          distribution: "corretto"
          java-version: "11"
          cache: maven
      - name: Maven settings
        uses: whelk-io/maven-settings-xml-action@v22
        with:
          servers: '[{ "id":"github-vol-active-support", "configuration": { "httpHeaders": { "property": { "name":"Authorization", "value":"Bearer ${{ secrets.GITHUB_TOKEN }}"} } } } ]'
      - name : Maven build
        uses: ./.github/workflows/maven.yaml
        with:
         maven-goal: package
      
    


